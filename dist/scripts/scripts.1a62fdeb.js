"use strict";angular.module("toolApp",["ngCookies","ngResource","ngSanitize","mm.foundation","ngAnimate","colorpicker.module","datePicker","ngClipboard"]).config(["$tooltipProvider",function(a){a.options({placement:"bottom",animation:!0,popupDelay:200,appendToBody:!0})}]);var app=angular.module("toolApp");app.controller("MyTool",["$scope","$http","dataHandler","ajax","$modal","$cookieStore",function(a,b,c,d,e,f){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.tabs=[{title:"添加组件",content:"views/tools.html"},{title:"画布管理",content:"views/canvas.html"},{title:"图层管理",content:"views/layer.html"}],a.ruler=!0,a.attrControl=!1,a.canvasPosition=1,a.borderColor="#888",a.wWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a.wHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a.width={c:950,b:990,self:a.wWidth-130},a.addOrder=[-1],a.canvastabs=[{title:"画布1",content:"views/canvasconfig.html"}],a.dataMks=JSON.parse(c.canvas(a.width.self,a.wHeight)),a.canvasOrder=0,a.indexCanvas=1,a.addCanvas=function(b){a.$broadcast("addWrap"),a.indexCanvas+=1,a.canvastabs.push({title:"画布"+a.indexCanvas,content:"views/canvasconfig.html"}),1!=b&&a.dataMks.mks.push({color:"transparent",img:{repeat:"no-repeat",url:"",position:"center"},widget:[]}),a.addOrder.push(-1)},a.confirmDelete=function(){a.$broadcast("removeWrap"),a.canvasOrder-=1,a.indexCanvas-=1,a.canvastabs.splice(a.indexCanvas,1),a.addOrder.splice(a.indexCanvas,1)},a.deleteCanvas=function(){g=1==a.canvastabs.length?4:a.canvasOrder==a.canvastabs.length-1?1:3;var b={name:a.canvastabs[a.canvasOrder].title,remove:a.confirmDelete,code:g};e.open({templateUrl:"views/myWindow.html",controller:"elementWindowCtrl",resolve:{data:function(){return b}}})};var g;a.order=-1,a.elementOrder=a.order+1,a.addElement=function(b){angular.isDefined(b)||(a.canvasOrder=a.indexCanvas-1),a.addOrder[a.canvasOrder]+=1,a.order=a.addOrder[a.canvasOrder],angular.isDefined(b)&&a.dataMks.mks[a.canvasOrder].widget.push(JSON.parse(c.element(b,a.order)))},a.remove=function(){angular.element(a.obj).remove(),a.attrControl=!1},a.deleteElement=function(){a.obj=document.getElementsByClassName(a.dataMks.mks[a.canvasOrder].widget[a.order].type+"_"+a.order),g=null===a.obj||angular.element(a.obj[1].children[4]).hasClass("fi-lock")?2:1;var b={name:a.canvastabs[a.canvasOrder].title+"中的"+a.dataMks.mks[a.canvasOrder].widget[a.order].name,remove:a.remove,code:g};e.open({templateUrl:"views/myWindow.html",controller:"elementWindowCtrl",resolve:{data:function(){return b}}})},a.clearElement=function(){a.confirmClear=function(){angular.element(document.querySelector(".clearElement")).scope().emptyWrap(a.canvasOrder),a.dataMks.mks[a.canvasOrder].widget.splice(0,a.dataMks.mks[a.canvasOrder].widget.length),a.addOrder[a.canvasOrder]=-1};var b={name:a.canvastabs[a.canvasOrder].title+"中的所有组件",remove:a.confirmClear,code:1};e.open({templateUrl:"views/myWindow.html",controller:"elementWindowCtrl",resolve:{data:function(){return b}}})},a.getImageSize=function(){var b=new Image;b.src=a.dataMks.mks[a.canvasOrder].widget[a.order].imgUrl,b.onload=function(){a.$apply(a.dataMks.mks[a.canvasOrder].widget[a.order].size.width=this.width,a.dataMks.mks[a.canvasOrder].widget[a.order].size.height=this.height)}},a.setLeft=function(){a.dataMks.offsetLeft=0===f.get("shoptype")?(a.dataMks.width-950)/2:(a.dataMks.width-990)/2},a.generateCode=function(){if(angular.isDefined(a.ckName)){a.getCode=function(b){a.setLeft(),d.generateCode(b,a.dataMks)};var b={action:a.getCode,code:11};e.open({templateUrl:"views/myWindow.html",controller:"windowCtrl",resolve:{data:function(){return b}}})}else a.login()},a.login=function(){a.setCk=function(){a.ckName=f.get("userName"),a.shopType=f.get("shoptype")};var b={action:a.setCk};e.open({templateUrl:"views/myWindow.html",controller:"loginWindowCtrl",resolve:{data:function(){return b}}})},a.ckName=f.get("userName"),a.shopType=f.get("shoptype"),a.logout=function(){f.remove("userName"),f.remove("shoptype"),delete a.ckName,delete a.shopType},a.preview=function(){a.setLeft(),d.preViewt(a.dataMks,a.ckName,f.get("shoptype"))},a.accountInfo=function(){e.open({templateUrl:"views/account.html",controller:"accountInfo",resolve:{data:function(){return a.ckName}}})},a.save=function(){a.smallTip=!0,angular.isDefined(a.jid)?d.updateData(a.dataMks,a.jid):d.saveData(a.dataMks,a.ckName)},a.jsonList=function(){e.open({templateUrl:"views/jsonlist.html",controller:"getJsonList",resolve:{data:function(){return a.ckName}}})},a["import"]=function(){a.getCode=function(b){console.log(b),a.addElement("import","",a.canvasOrder)},e.open({templateUrl:"views/import.html",controller:"import",resolve:{data:function(){return a.getCode}}})}}]),app.controller("elementWindowCtrl",["$scope","$modalInstance","data",function(a,b,c){a.name=c.name,a.code=c.code;var d=c.remove;a.ok=function(){b.close(d())},a.cancel=function(){b.dismiss("cancel")}}]),app.controller("windowCtrl",["$scope","$modalInstance","data","$timeout",function(a,b,c,d){a.code=c.code;var e=c.action;a.ok=function(a){e(a)},a.cancel=function(){b.dismiss("cancel")},a.getCodeToCopy=function(){return a.htmlCode},a.copied=!1,a.doSomething=function(){a.copied=!0,d(function(){a.copied=!1},2e3)},a.$on("codeGenerateSuccess",function(b,c){a.htmlCode=c})}]),app.controller("loginWindowCtrl",["$scope","$modalInstance","data","md5","$http","$timeout","$cookieStore",function(a,b,c,d,e,f,g){a.code=12;var h=c.action;a.cancel=function(){b.dismiss("cancel")},a.login=function(){e({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/login",data:{name:a.userName,pass:angular.isDefined(a.userPass)?d.createHash(a.userPass):""}}).success(function(c){a.backCode=c.code,0===c.code&&(a.showSuccess=!0,a.dbName=c.name,g.put("userName",a.dbName),g.put("shoptype",c.shoptype),h(),f(function(){a.showSuccess=!1,b.dismiss("cancel")},1e3))})},a.hide=function(){(1==a.backCode||2==a.backCode)&&(a.backCode=0)}}]),app.controller("getJsonList",["$scope","ajax","$modalInstance","data","$timeout",function(a,b,c,d,e){var f=d;a.ajax=function(c,d,g,h){a.deletea="delete"==c?!0:!1,b.getJsonList(c,f,d,g,h),a.$on("getlist",function(b,d){a.jsonlist=d.data,a.totalItems=d.total,"delete"==c&&e(function(){a.deletea=!1},1500)})},a.cancel=function(){c.dismiss("cancel")},a.currentPage=1,a.maxSize=5,a.ajax("getlist",a.currentPage),a.goPage=function(b){a.ajax("getlist",b)},a.open=function(a){b.open(a),c.dismiss("cancel")}}]),app.controller("import",["$scope","$modalInstance",function(a,b){a.ok=function(){angular.isDefined(a.htmlCode)&&a.$emit("import",a.htmlCode),a.cancel()},a.cancel=function(){b.dismiss("cancel")}}]),app.controller("accountInfo",["$scope","md5","ajax","$modalInstance","data","$timeout",function(a,b,c,d,e,f){var g=e;c.getDate("userdata",g),a.$on("userDataReady",function(b,c){a.userData=c.data,a.backCode=c.code,3==a.backCode&&f(function(){a.backCode=0,a.code=1},1500)}),a.cancel=function(){d.dismiss("cancel")},a.code=1,a.change=function(){a.userPass==a.confirmPass&&angular.isDefined(a.userPass)&&angular.isDefined(a.beforePass)?c.getDate("changepass",g,b.createHash(a.beforePass),b.createHash(a.userPass)):a.backCode=angular.isUndefined(a.beforePass)?1:2},a.hide=function(a){(1==a.backCode||2==a.backCode)&&(a.backCode=0)}}]),Date.prototype.format=function(a,b){function c(a,b){return 2==b?a%4===0?29:28:1==b||3==b||5==b||7==b||8==b||10==b||12==b?31:30}(null===a||""===a)&&(a="y-m-d h:n:s");var d=this.getFullYear(),e=this.getMonth()+1,f=this.getDate(),g=this.getHours(),h=this.getMinutes(),i=this.getSeconds(),j=a.replace(/y+/gi,d);return"future"==b&&(f==c(d,e)?(12==e?(d+=1,e=1):e+=1,f=2):f+=2),j=j.replace(/m+/gi,(10>e?"0":"")+e),j=j.replace(/d+/gi,(10>f?"0":"")+f),j=j.replace(/h+/gi,(10>g?"0":"")+g),j=j.replace(/n+/gi,(10>h?"0":"")+h),j=j.replace(/s+/gi,(10>i?"0":"")+i)};var app=angular.module("toolApp");app.directive("draggable",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){angular.element(c).attr("draggable","true"),c.bind("dragstart",function(b){b.dataTransfer.setData("type",d.directive),a.$emit("dragStart")}),c.bind("dragend",function(){a.$emit("dragEnd")})}}}]),app.directive("droppable",["$rootScope","$compile","$position",function(a,b,c){return{restrict:"A",link:function(d,e){function f(a,c,f){angular.element(e[0].children[f]).append("wwgroup"==a||"ww"==a||"jdservice"==a||"import"==a?b('<div loadx="'+c+'" '+a+" yd-drag></div>")(d):b('<div loadx="'+c+'" '+a+" yd-drag yd-resize></div>")(d))}function g(a,c,e,f){var g='<p class="eButton '+c+"_"+a+' now" index="'+a+'"><span class="left">'+e+'</span><i class="icon fi-x size-14 right" ng-click="deleteElement()" ></i><i class="icon fi-arrow-down size-14 actChangeZindex right" tooltip="下移"></i><i class="icon fi-arrow-up size-14 actChangeZindex right" tooltip="上移"></i><i class="icon fi-unlock size-14 actLock right" tooltip="锁定"></i></p>';angular.element(document.querySelector(".layer_"+f)).prepend(b(g)(d))}function h(){angular.element(e[0].children[0]).empty().append(b('<div class="gridbg"></div>')(d)),angular.element(document.querySelector(".layer_0")).empty(),d.order=-1,d.addOrder=[-1],d.canvasOrder=d.indexCanvas-1;for(var a=1;d.indexCanvas>1;a++)d.confirmDelete()}function i(){l='<li style="background-color:{{dataMks.slider.nav.bgColor}};border-color:{{dataMks.slider.nav.borderColor}};color:{{dataMks.slider.nav.color}};">'+(p+1)+"</li>",n='<ul class="slidenav {{dataMks.slider.nav.align}} eButton" index="-1" yd-drag ng-class="{\'hide\':!dataMks.slider.nav.enable}" style="left:{{dataMks.slider.nav.position.left}}px;top:{{dataMks.slider.nav.position.top}}px;"><li class="act" style="background-color:{{dataMks.slider.nav.bgColor}};border-color:{{dataMks.slider.nav.borderColor}};color:{{dataMks.slider.nav.color}};">1</li>'+l+'</ul><span ng-class="{\'hide\':!dataMks.slider.arrow.enable}" class="slidearrow slidearrowl eButton" style="left:{{dataMks.slider.arrow.leftPosition.left}}px;top:{{dataMks.slider.arrow.leftPosition.top}}px;" index="-2" ng-class="{\'hide\':!dataMks.slider.arrow.enable}" yd-drag><img src="{{dataMks.slider.arrow.leftUrl}}"></span><span ng-class="{\'hide\':!dataMks.slider.arrow.enable}" index="-2" class="slidearrow slidearrowr eButton" style="left:{{dataMks.slider.arrow.rightPosition.left}}px;top:{{dataMks.slider.arrow.rightPosition.top}}px;" yd-drag><img src="{{dataMks.slider.arrow.rightUrl}}"></span>',k='<div class="wrap_'+p+' wrap" style="width:{{dataMks.width}}px;height:{{dataMks.height}}px;background-repeat:{{dataMks.mks['+p+"].img.repeat}};background-color:{{dataMks.mks["+p+"].color}};background-position:{{dataMks.mks["+p+"].img.position}} center;\" ng-style=\"{'background-image': 'url('+dataMks.mks["+p+'].img.url+\')\'}"><div class="gridbg"></div></div>',m='<div class="wrap_'+p+" layer_"+p+' wrap">',0===o?angular.element(document.querySelector(".canvas")).append(b(n)(d)):angular.element(document.querySelector(".slidenav")).append(b(l)(d)),angular.element(document.querySelector(".wrap_"+o)).after(b(k)(d)),angular.element(document.querySelector(".layer_"+o)).after(b(m)(d)),p+=1,o+=1}function j(){if(o===d.canvasOrder){if(1===o)angular.element(document.querySelector(".slidenav")).remove(),angular.element(document.querySelector(".slidearrow")).remove();else{var a=angular.element(document.querySelectorAll(".slidenav li"));a[a.length-1].remove()}angular.element(document.querySelector(".wrap_"+o)).remove(),angular.element(document.querySelector(".layer_"+o)).remove(),d.dataMks.mks.splice(o,1),p-=1,o-=1}}e.bind("dragover",function(a){return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.dataTransfer.dropEffect="move",!1}),e.bind("drop",function(a){a.preventDefault&&a.preventDefault(),a.stopPropogation&&a.stopPropogation();var b=a.dataTransfer.getData("type");d.addElement(b),d.attrControl=!0,"imgpop"==b&&(b="img");var h,i,j,k,l,m;"wwgroup"==b||"ww"==b||"jdservice"==b?(j=d.dataMks.height,k=d.dataMks.width,l=a.clientX-c.offset(e).left,m=a.clientY-c.offset(e).top):(h=d.dataMks.mks[d.canvasOrder].widget[d.order].size.width,i=d.dataMks.mks[d.canvasOrder].widget[d.order].size.height,j=d.dataMks.height-i,k=d.dataMks.width-h,l=a.clientX-c.offset(e).left-h/2,m=a.clientY-c.offset(e).top-i/2),0>m?m=0:m>j&&(m=j),0>l?l=0:l>k&&(l=k),f(b,"",d.canvasOrder),d.dataMks.mks[d.canvasOrder].widget[d.order].position.left=l,d.dataMks.mks[d.canvasOrder].widget[d.order].position.top=m,g(d.order,d.dataMks.mks[d.canvasOrder].widget[d.order].type,d.dataMks.mks[d.canvasOrder].widget[d.order].name,d.canvasOrder)}),a.$on("dragStart",function(){e.addClass("drop-target")}),a.$on("dragEnd",function(){angular.element(document.getElementById("workspace")).removeClass("move-right"),e.removeClass("drop-target")});var k,l,m,n,o=0,p=1;a.$on("import",function(a,b){d.addElement("import"),d.dataMks.mks[d.canvasOrder].widget[d.order].code=b,f("import","",d.canvasOrder),d.dataMks.mks[d.canvasOrder].widget[d.order].position.left=50,d.dataMks.mks[d.canvasOrder].widget[d.order].position.top=50,g(d.order,"import",d.dataMks.mks[d.canvasOrder].widget[d.order].name,d.canvasOrder)}),d.$on("addWrap",i),d.$on("removeWrap",j),d.$on("open",function(a,b){h(),d.dataMks=b.data,d.jid=b.jid;var c=d.dataMks.mks;for(var e in c){e>0&&d.addCanvas(1);var i=c[e].widget;if(i.length>0)for(var j in i)i[j].type&&(f(i[j].type,j,e),g(j,i[j].type,i[j].name,e),d.addElement())}})}}}]),app.directive("eButton",function(){return{restrict:"C",link:function(a,b,c){function d(){angular.element(document.querySelectorAll(".now")).removeClass("now")}function e(){d(),angular.element(document.querySelectorAll("."+b[0].className.split(" ")[1])).addClass("now"),angular.isUndefined(a.order)?a.$apply(a.$parent.order=c.index,a.$parent.attrControl=!0):a.$apply(a.order=c.index,a.attrControl=!0)}d(),b.on("mousedown",e)}}}),app.directive("actChangeZindex",["$timeout",function(a){return{restrict:"C",link:function(b,c){function d(){var d,e=c.parent();if(d=c.hasClass("fi-arrow-down")?e.next():angular.element(e[0].previousSibling),1===d.length&&angular.element(e.children()[4]).hasClass("fi-unlock")){d.addClass("changing"),a(function(){c.hasClass("fi-arrow-down")?d.after(e):e.parent()[0].insertBefore(e[0],d[0]),d.removeClass("changing")},300);var f=e.attr("class").replace(/[^0-9]/gi,""),g=d.attr("class").replace(/[^0-9]/gi,""),h=b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[f].zindex;b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[f].zindex=b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[g].zindex,b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[g].zindex=h}}c.bind("mousedown",d)}}}]),app.directive("actLock",function(){return{restrict:"C",link:function(a,b){b.bind("mousedown",function(){b.hasClass("fi-unlock")?b.removeClass("fi-unlock").addClass("fi-lock"):b.removeClass("fi-lock").addClass("fi-unlock")})}}}),app.directive("clearElement",function(){return{restrict:"C",link:function(a){a.emptyWrap=function(a){angular.element(document.querySelector(".wrap_"+a)).empty().append('<div class="gridbg"></div>'),angular.element(document.querySelector(".layer_"+a)).empty()}}}}),app.directive("gridbg",function(){return{restrict:"C",link:function(a,b){b.bind("click",function(){angular.element(document.querySelectorAll(".now")).removeClass("now"),a.$apply(a.attrControl=!1)})}}}),app.directive("datefilter",function(){return{restrict:"A",require:["ngModel"],link:function(a,b,c,d){d[0].$formatters.push(function(b){return angular.isDefined(b)?(a.$parent.$parent.$parent.dataMks.mks[c.canvasorder].widget[c.order].time=b,b):void 0})}}}),app.directive("smalltip",["$timeout",function(a){return{restrict:"E",replace:!0,template:"<div class=\"smalltip text-center load animated\" ng-class=\"{'fadeInDown':smallTip,'fadeOutUp':smallTip==null}\">保存中...</div>",link:function(b,c){function d(){e.removeClass("load").text("保存成功"),a(function(){b.smallTip=null},2e3)}var e=angular.element(c);b.$on("savestatus",function(a,c){1==c.code?(b.jid=c.jid,d()):e.text(c.code)}),b.$on("updatestatus",function(a,b){1==b?(e.removeClass("load").text("保存成功"),d()):e.text(b)})}}}]),app.directive("preview",["$cookieStore","$compile",function(a,b){return{restrict:"C",link:function(c,d){c.$on("viewSuccess",function(e,f){10==f&&(c.preViewShow=!0,c.htmlUrl="shop_"+a.get("shoptype")+"_"+c.ckName,angular.element(d.children()[0]).empty().append(b('<iframe ng-src="http://www.tiancaiui.com/tool/ajax/index.php/make/show/'+c.htmlUrl+'">')(c)))})}}}]),app.directive("mAppLoading",["$animate",function(a){return{restrict:"C",link:function(b,c,d){a.leave(c.children().eq(1)).then(function(){c.remove(),b=c=d=null})}}}]);var app=angular.module("toolApp");app.directive("area",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/area.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("img",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/img.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("imgtwo",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/img.html",link:function(a,b,c){function d(){a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].hover.status&&(b[0].children[0].src=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].hover.imgUrl)}function e(){a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].hover.status&&(b[0].children[0].src=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].imgUrl)}function f(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("mouseover",d).on("mouseleave",e).on("$destroy",f)}}}).directive("imgeffect",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/imgeffect.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("text",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/text.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("paragraph",["$compile",function(a){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/paragraph.html",link:function(b,c,d){function e(){delete b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index]}b.index=""!==d.loadx?d.loadx:b.$parent.order,b.$on("marquee",function(){var d;d=b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].scrollStatus?'<marquee direction="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].scrollMode}}" scrollamount="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].scrollSpeed}}" height="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}" width="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}" behavior="scroll">{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].text}}</marquee>':"<div>{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].text}}</div>",angular.element(c[0].children[0]).empty().append(a(d)(b))}),c.on("$destroy",e)}}}]).directive("countdown",["$timeout",function(a){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/countdown.html",link:function(b,c,d){function e(){delete b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index]}b.index=""!==d.loadx?d.loadx:b.$parent.order,b.days=2,b.seconds=b.minutes=b.hours="00",b.countdown=function(){var c,d,e,f,g,h,i,j,k,l;k=Date.parse(""!==b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].time?b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].time:b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].placetime),c=k-Date.parse(new Date),l=b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].show,a(function(){g=Math.floor(c/864e5),d=c%864e5,e=d%36e5,f=e%6e4,h=Math.floor(d/36e5),i=Math.floor(e/6e4),j=Math.round(f/1e3),4>l&&(h+=24*g,l>1&&(i+=60*h,3==l&&(j+=60*i))),b.days=(1>g?"0":"")+g,b.hours=(10>h?"0":"")+h,b.minutes=(10>i?"0":"")+i,b.seconds=(10>j?"0":"")+j,b.countdown()},1e3)},b.countdown(),b.$on("show",function(){for(var a=b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].show,d=0;4>d;d++)a>d&&4!=a?angular.element(c.children()[d]).css("display","none"):angular.element(c.children()[d]).css("display","inline-block")}),c.on("$destroy",e)}}}]).directive("cart",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/cart.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("qrcode",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/qrcode.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("search",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/search.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order;var e,f;a.$on("transparent",function(){1==a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].showStyle?(e=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].mkColor,f=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].inputBgColor,a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].mkColor=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].inputBgColor="transparent",b.children()[0].src=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].imgUrl):(a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].mkColor=e,a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].inputBgColor=f,b.children()[0].src="")}),b.on("$destroy",d)}}}).directive("video",["$sce",function(a){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/video.html",link:function(b,c,d){function e(){delete b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index]}b.index=""!==d.loadx?d.loadx:b.$parent.order,b.trustSrc=function(b){return a.trustAsResourceUrl(b)},c.on("$destroy",e)}}}]).directive("wwgroup",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/wwgroup.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,a.$on("changeStyle",function(){var b=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].imgStyle;a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].img=1==b?"http://img01.taobaocdn.com/bao/uploaded/i1/T15nj0FopXXXartXjX":2==b?"http://img01.taobaocdn.com/bao/uploaded/i3/T14kLTFaXdXXartXjX":3==b?"http://img01.taobaocdn.com/bao/uploaded/i3/T1mtDYFodbXXartXjX":"http://img01.taobaocdn.com/bao/uploaded/i4/T1ZsYpFfpgXXartXjX"}),b.on("$destroy",d)}}}).directive("ww",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/ww.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("jdservice",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/jdservice.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("attention",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/attention.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("favourite",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/attention.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("share",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/share.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,a.$on("changeShareStyle",function(){var b=a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].showStyle;a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index].imgUrl=1==b?"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2U3D3bFXXXXbXXpXXXXXXXXXX-134264536.png":2==b?"none":"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2uwf1bFXXXXbFXpXXXXXXXXXX-134264536.png"}),b.on("$destroy",d)}}}).directive("carousel",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/carousel.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("carouseline",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/carouseline.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("accordiona",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/accordiona.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,a.active=0,b.on("$destroy",d)}}}).directive("comment",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/comment.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("userdefine",function(){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/userdefine.html",link:function(a,b,c){function d(){delete a.$parent.dataMks.mks[a.$parent.canvasOrder].widget[a.index]}a.index=""!==c.loadx?c.loadx:a.$parent.order,b.on("$destroy",d)}}}).directive("import",["$compile",function(a){return{restrict:"A",transclude:!0,replace:!0,scope:{},templateUrl:"template/widget/import.html",link:function(b,c,d){function e(){delete b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index]}b.index=""!==d.loadx?d.loadx:b.$parent.order,angular.element(c).append(a(b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].code)(b)),c.on("$destroy",e)}}}]),app.run(["$templateCache",function(a){a.put("template/widget/area.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/img.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgUrl}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/imgeffect.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgUrl}}"><img class="imghover" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].hover.position.left}}px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].hover.position.top}}px;" ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].hover.imgUrl}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/text.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;line-height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].lineht}}px;font-size:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].fontsize}}px;font-weight:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].weight}};color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].color}};font-family:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].font}};">{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].text}}</div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/paragraph.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;line-height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].lineht}}px;font-size:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].fontsize}}px;font-weight:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].weight}};color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].color}};font-family:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].font}};"><div class="text_bd">{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].text}}</div></div>')
}]),app.run(["$templateCache",function(a){a.put("template/widget/countdown.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;line-height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].lineht}}px;font-size:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].fontsize}}px;font-weight:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].weight}};color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].color}};font-family:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].font}};"><span style="background-image:url({{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}});margin:0 {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].margin}}px;">{{days}}<em ng-class="{\'hide\':!$parent.dataMks.mks[$parent.canvasOrder].widget[index].units}">天</em></span><span style="background-image:url({{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}});margin:0 {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].margin}}px;">{{hours}}<em ng-class="{\'hide\':!$parent.dataMks.mks[$parent.canvasOrder].widget[index].units}">时</em></span><span style="background-image:url({{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}});margin:0 {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].margin}}px;">{{minutes}}<em ng-class="{\'hide\':!$parent.dataMks.mks[$parent.canvasOrder].widget[index].units}">分</em></span><span style="background-image:url({{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}});margin:0 {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].margin}}px;">{{seconds}}<em ng-class="{\'hide\':!$parent.dataMks.mks[$parent.canvasOrder].widget[index].units}">秒</em></span></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/cart.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgUrl}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/qrcode.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img src="http://gqrcode.alicdn.com/img?{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].qrtype}}={{$parent.dataMks.mks[$parent.canvasOrder].widget[index].id}}&w={{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}&h={{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/search.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} status{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].showStyle}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img src=""><div yd-drag class="search_keyword" index="{{index}}" style="width: {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].input.size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].input.size.height}}px;left: {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].input.position.left}}px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].input.position.top}}px;border-color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].mkColor}};background-color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].inputBgColor}};"></div><div yd-drag class="search_btn" index="{{index}}" style="width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].btn.size.width}}px; height: {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].btn.size.height}}px;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].btn.position.left}}px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].btn.position.top}}px;border-color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].mkColor}};background-color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].mkColor}};line-height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].btn.size.height}}px;">搜索</div></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/video.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><iframe src="{{trustSrc($parent.dataMks.mks[$parent.canvasOrder].widget[index].videolink)}}" width="100%" height="100%" frameborder="0"></iframe></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/wwgroup.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/ww.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}}"><br><img ng-class="{\'toux\':$parent.dataMks.mks[$parent.canvasOrder].widget[index].img!=\'\'&&$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgStyle==2}" ng-src="images/tool/ww{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgStyle}}.gif"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/jdservice.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].img}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/attention.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img ng-src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgUrl}}"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/share.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><div class="style{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].showStyle}}" style="width:100%;height:100%;background-image:url({{$parent.dataMks.mks[$parent.canvasOrder].widget[index].imgUrl}});font-family:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].font}};color:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].color}};font-size:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].fontsize}}px;font-weight:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].weight}};">分享给好友</div></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/carousel.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><img src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].content[0].imgurl}}"><span class="yd" style="z-index:99;cursor:pointer;left:10px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height/2-40}}px;"><img src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].leftUrl}}"></span><span class="yd" style="z-index:99;cursor:pointer;right:10px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height/2-40}}px;"><img src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].rightUrl}}"></span></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/carouseline.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><div style="width:9999999px;height:100%;"><div class="list" ng-repeat="carousel in $parent.dataMks.mks[$parent.canvasOrder].widget[index].content"><img ng-src="{{carousel.imgurl}}"></div><div class="list" ng-repeat="carousel in $parent.dataMks.mks[$parent.canvasOrder].widget[index].content"><img ng-src="{{carousel.imgurl}}"></div></div><span class="yd" style="z-index:99;cursor:pointer;left:0px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height/2-40}}px;"><img src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].leftUrl}}"></span><span class="yd" style="z-index:99;cursor:pointer;right:0px;top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height/2-40}}px;"><img src="{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].rightUrl}}"></span></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/accordiona.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><div class="list" ng-repeat="accordion in $parent.dataMks.mks[$parent.canvasOrder].widget[index].content"><div class="ks-content" ng-show="active=={{$index}}"><img ng-src="{{accordion.imgurl}}"></div><div class="trigger"><img accordion ng-click="$parent.active=$index" ng-src="{{accordion.ximgurl}}"></div></div></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/comment.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now sns-widget sns-comment sns-widget-ui" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><div class="comment-widget"><div class="comment-edit"><div class="comment-add"><div class="textarea-b"><textarea class="f-txt" resize="none" style="" placeholder="我也插句话..."></textarea></div><div class="act"><span class="skin-blue"><em class="J_LetterCount">0/140</em><span class="btn"><a href="#" class="J_PostComment">评论</a></span></span><a href="#" class="face">表情</a><label><input type="checkbox" class="ui-buttonset"> 同时转发到我的淘宝</label></div></div></div></div></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/userdefine.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;width:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.width}}px;height:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].size.height}}px;"><div ng-bind-html="$parent.dataMks.mks[$parent.canvasOrder].widget[index].code | unsafe"></div>')}]),app.run(["$templateCache",function(a){a.put("template/widget/import.html",'<div class="eButton {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}}_{{index}} {{$parent.dataMks.mks[$parent.canvasOrder].widget[index].type}} now" index="{{index}}" style="position:absolute;left:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.left}}px;z-index:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].zindex}};top:{{$parent.dataMks.mks[$parent.canvasOrder].widget[index].position.top}}px;"></div>')}]);var app=angular.module("toolApp");app.directive("carouselAction",function(){return{restrict:"C",link:function(a,b){b.bind("mousedown",function(){var c=angular.element(b).parent().hasClass("carousel")?"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2EcBWcXXXXXcHXpXXXXXXXXXX-134264536.jpg":"http://img02.taobaocdn.com/imgextra/i2/134264536/TB27kiacXXXXXX4XXXXXXXXXXXX-134264536.jpg",d=a.$parent.$parent.$parent.dataMks.mks[a.$parent.$parent.$parent.canvasOrder].widget[a.$parent.$parent.$parent.order];b.hasClass("fi-plus")?d.content.push({imgurl:c,link:"http://www.tiancaiui.com"}):d.content.pop()})}}}),app.directive("accordion",["$document",function(a){return{restrict:"A",link:function(b,c){function d(a){var c=a.pageY-g,d=a.pageX-f;b.$apply(function(){b.$parent.$parent.dataMks.mks[b.$parent.$parent.canvasOrder].widget[b.$parent.index].position.left=d,b.$parent.$parent.dataMks.mks[b.$parent.$parent.canvasOrder].widget[b.$parent.index].position.top=c}),h.css({top:c+"px",left:d+"px"}).addClass("opacity")}function e(){a.unbind("mousemove",d),a.unbind("mouseup",e),h.removeClass("opacity")}var f=0,g=0,h=angular.element(c).parent().parent().parent();c.bind("mousedown",function(b){event.preventDefault(),f=b.pageX-parseInt(h.css("left")),g=b.pageY-parseInt(h.css("top")),a.bind("mousemove",d),a.bind("mouseup",e)})}}}]),app.directive("accordionAction",function(){return{restrict:"C",link:function(a,b){b.bind("mousedown",function(){var c=a.$parent.$parent.$parent.dataMks.mks[a.$parent.$parent.$parent.canvasOrder].widget[a.$parent.$parent.$parent.order];b.hasClass("fi-plus")?c.content.push({imgurl:"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2xpD9XXXXXXX5XFXXXXXXXXXX-134264536.jpg",ximgurl:"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2x9iXcXXXXXcHXXXXXXXXXXXX-134264536.jpg",link:"http://www.tiancaiui.com"}):c.content.pop()})}}}),app.directive("imghover",["$document",function(a){return{restrict:"C",link:function(b,c){function d(a){var c=a.pageY-g,d=a.pageX-f;b.$apply(function(){b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].hover.position.left=d,b.$parent.dataMks.mks[b.$parent.canvasOrder].widget[b.index].hover.position.top=c}),h.css({top:c+"px",left:d+"px"}).addClass("opacity")}function e(){a.unbind("mousemove",d),a.unbind("mouseup",e),h.removeClass("opacity")}var f=0,g=0,h=angular.element(c);c.bind("mousedown",function(b){event.preventDefault(),f=b.pageX-parseInt(h.css("left")),g=b.pageY-parseInt(h.css("top")),a.bind("mousemove",d),a.bind("mouseup",e)})}}}]),angular.module("toolApp").service("dataHandler",function(){this.canvas=function(a,b){return'{"jname": "未命名","width":'+a+',"height":'+(b-160)+',"offset":"margin:0 auto","offsetLeft": 0,"slider": {"arrow": {"enable": true,"leftUrl": "http://img01.taobaocdn.com/bao/uploaded/i2/T1kqzaFhtaXXaCwpjX","leftPosition": { "left": 200,"top": '+(b-200)/2+'},"rightUrl": "http://img01.taobaocdn.com/bao/uploaded/i1/T1eJnPXeNrXXaCwpjX","rightPosition": { "left": '+(a-200)+',"top": '+(b-200)/2+'}},"nav": {"enable": true,"bgColor": "#cccccc","borderColor": "#666666", "color": "#666666","align": "left","position": {"left": '+(a-70)/2+',"top": '+(b-220)+'}},"effect": "scrollx","duration": 0.5,"autoplay": true},"mks": [{ "color": "transparent","img": {"repeat": "no-repeat","url": "","position":"center"}, "widget": []}],"version": 1}'},this.element=function(a,b){switch(a){case"area":return'{"id": '+b+',"zindex": '+b+',"name": "热点层'+(b+1)+'","type": "area","position": {"left": 200,"top": 100},"size": {"width": 100,"height": 100},"link": ""}';case"img":return'{"id": '+b+',"zindex": '+b+',"name": "图片层'+(b+1)+'","type": "img","position": {"left": 200,"top": 100},"size": {"width": 310,"height": 390},"imgUrl": "http://img02.taobaocdn.com/imgextra/i2/134264536/TB2b21EXVXXXXa9XpXXXXXXXXXX-134264536.jpg","link": ""}';case"imgtwo":return'{"id": '+b+',"zindex": '+b+',"name": "正反面'+(b+1)+'","type": "imgtwo","position": {"left": 200,"top": 100},"size": {"width": 320,"height": 430},"imgUrl": "http://img04.taobaocdn.com/imgextra/i4/134264536/TB2cjqfXVXXXXa2XpXXXXXXXXXX-134264536.jpg","link": "","hover": {"status": true,"imgUrl": "http://img01.taobaocdn.com/imgextra/i1/134264536/TB2Z1KecXXXXXbvXXXXXXXXXXXX-134264536.jpg"}}';case"imgeffect":return'{"id": '+b+',"zindex": '+b+',"name": "悬浮特效'+(b+1)+'","type": "imgeffect","position": {"left": 200,"top": 100},"size": {"width": 390,"height": 490},"imgUrl": "http://img04.taobaocdn.com/imgextra/i4/134264536/TB2EwOhcXXXXXX0XXXXXXXXXXXX-134264536.jpg","link": "","hover": {"position": {"left": 29,"top": 340},"imgUrl": "http://img04.taobaocdn.com/imgextra/i4/134264536/TB2a9SecXXXXXa4XpXXXXXXXXXX-134264536.png"}, "transition":{"time":"05","effect":"ease-in","display":"yd-box-fadein","transX":"none","transY":"yd-box-dy40","css3":"none"}}';case"text":return'{"id": '+b+',"zindex": '+b+',"name": "文本层'+(b+1)+'","type": "text","position": {"left": 200,"top": 100},"size": {"width": 200,"height": 20},"text": "这是一个文本区","link": "", "font": "microsoft yahei","fontsize": 14,"lineht":14,"weight": 100,"color": "#000"}';case"paragraph":return'{"id": '+b+',"zindex": '+b+',"name": "段落层'+(b+1)+'","type": "paragraph","position": {"left": 200,"top": 100},"size": {"width": 200,"height": 100},"text": "我们是专业的店铺装修工作室，致力于各行业店铺模板的设计","font": "microsoft yahei","fontsize": 14,"lineht":14,"weight": 100,"color": "#000","scrollStatus": false,"scrollMode": "left","scrollSpeed": 5}';case"countdown":return'{"id": '+b+',"zindex": '+b+',"name": "倒计时'+(b+1)+'","type": "countdown","placetime": "'+(new Date).format("y-m-d h:n:s","future")+'","time":"","show":4,"position": {"left": 100,"top": 100},"size": {"width":305,"height":55},"margin":0,"lineht":36,"img":  "http://img01.taobaocdn.com/bao/uploaded/i2/T1H0_cFg4dXXaCwpjX","font": "impact","fontsize": 36,"weight": 100,"color": "#fff","units":true}';case"cart":return'{"id": '+b+',"zindex": '+b+',"name": "购物车'+(b+1)+'","type": "cart","position": {"left": 100,"top": 100},"size": {"width":50,"height":50},"imgUrl":  "http://img02.taobaocdn.com/imgextra/i2/134264536/T2RjJ8X64XXXXXXXXX-134264536.png","itemid":""}';case"qrcode":return'{"id": '+b+',"zindex": '+b+',"name": "二维码'+(b+1)+'","type": "qrcode","position": {"left": 100,"top": 100},"size": {"width":140,"height":140}, "qrtype":"v=1&type=bs&shop_id","id":"123456"}';case"search":return'{"id": '+b+',"zindex": '+b+',"name": "搜索框'+(b+1)+'","type": "search","position": {"left": 100,"top":100},"size": {"width":394,"height":35}, "input": {"position": {"left": 0,"top": 0},"size": {"width": 300,"height": 32}},"btn": {"position": { "left": 303,"top": 0 },"size": {"width": 90,"height":32}},"shoplink": "","textColor": "#000000", "showStyle": 0,"mkColor": "#fa7f14","inputBgColor": "#ffffff","imgUrl": "http://img01.taobaocdn.com/bao/uploaded/i3/T1cs0cFdXfXXaCwpjX"}';case"video":return'{"id": '+b+',"zindex": '+b+',"name": "视频层'+(b+1)+'","type": "video","position": {"left": 100,"top":100},"size": {"width":300,"height":300},"videolink":"http://player.youku.com/player.php/Type/Folder/Fid/23322150/Ob/1/sid/XODc2MzA4NDE2/v.swf"}';case"wwgroup":return'{"id": '+b+',"zindex": '+b+',"name": "旺旺群'+(b+1)+'","type": "wwgroup","position": {"left": 100,"top":100},"img": "http://img01.taobaocdn.com/bao/uploaded/i4/T1ZsYpFfpgXXartXjX","wwGroupId":123456, "imgStyle": 1}';case"ww":return'{"id": '+b+',"zindex": '+b+',"name": "在线客服'+(b+1)+'","type": "ww","position": {"left": 100,"top":100},"img": "http://img04.taobaocdn.com/imgextra/i4/134264536/T2fMp6X6RaXXXXXXXX-134264536.gif","wwId":"", "imgStyle": 1}';case"jdservice":return'{"id": '+b+',"zindex": '+b+',"name": "在线客服'+(b+1)+'","type": "jdservice","position": {"left": 100,"top":100},"img": "http://img11.360buyimg.com/cms/jfs/t625/297/864798345/3219/6c8f477b/548fe1c3N9f50938a.gif","shopId":""}';case"attention":return'{"id": '+b+',"zindex": '+b+',"name": "天猫关注'+(b+1)+'","type": "attention","size": {"width":83,"height":24},"position": {"left": 100,"top":100},"imgUrl": "http://img01.taobaocdn.com/bao/uploaded/i3/T1ROYFFn8eXXaCwpjX","brandid":""}';case"favourite":return'{"id": '+b+',"zindex": '+b+',"name": "店铺收藏'+(b+1)+'","type": "favourite","size": {"width":190,"height":160},"position": {"left": 100,"top":100},"imgUrl": "http://img03.taobaocdn.com/imgextra/i3/134264536/TB2w22ZbFXXXXb0XpXXXXXXXXXX-134264536.gif","favouriteurl":""}';case"share":return'{"id": '+b+',"zindex": '+b+',"name": "分享层'+(b+1)+'","type": "share","size": {"width":92,"height":27},"position": {"left": 100,"top":100},"imgUrl": "http://img04.taobaocdn.com/imgextra/i4/134264536/TB2U3D3bFXXXXbXXpXXXXXXXXXX-134264536.png","shareType":"item","id":"","showStyle":1,"font": "simsun","fontsize": 12,"weight": 100,"color": "#666"}';case"carousel":return'{"id": '+b+',"zindex": '+b+',"name": "图片轮播'+(b+1)+'","type": "carousel","effect":"scrollx","duration": 0.5,"autoplay": true,"easing":"easeBoth","size": {"width":500,"height":350},"position": {"left": 100,"top":100},"leftUrl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2WLNWcXXXXXcQXpXXXXXXXXXX-134264536.png","rightUrl": "http://img04.taobaocdn.com/imgextra/i4/134264536/TB2Ll44cXXXXXcuXXXXXXXXXXXX-134264536.png","content":[{"imgurl":"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2EcBWcXXXXXcHXpXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2g9dZcXXXXXbeXpXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"}]}';case"carouseline":return'{"id": '+b+',"zindex": '+b+',"name": "无缝轮播'+(b+1)+'","type": "carouseline","effect":"scrollx","duration": 0.5,"autoplay": true,"easing":"easeBoth","step":1,"size": {"width":975,"height":484},"position": {"left": 100,"top":100},"leftUrl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2oWzDXXXXXXXwXVXXXXXXXXXX-134264536.png","rightUrl": "http://img01.taobaocdn.com/imgextra/i1/39767794/TB2RIxNbXXXXXc_XXXXXXXXXXXX-39767794.png","content":[{"imgurl":"http://img02.taobaocdn.com/imgextra/i2/134264536/TB27kiacXXXXXX4XXXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img03.taobaocdn.com/imgextra/i3/134264536/TB2oZebcXXXXXX1XXXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2KZd_cXXXXXcUXXXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"}]}';case"accordiona":return'{"id": '+b+',"zindex": '+b+',"name": "手风琴'+(b+1)+'","type": "accordiona","triggerType":"mouse","size": {"width":1001,"height":428},"position": {"left": 100,"top":100},"content":[{"imgurl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2xpD9XXXXXXX5XFXXXXXXXXXX-134264536.jpg","ximgurl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2x9iXcXXXXXcHXXXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2iTWXcXXXXXc6XXXXXXXXXXXX-134264536.jpg","ximgurl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2JV5XcXXXXXXBXpXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img03.taobaocdn.com/imgextra/i3/134264536/TB2_jSDXVXXXXa8XpXXXXXXXXXX-134264536.jpg","ximgurl":"http://img02.taobaocdn.com/imgextra/i2/134264536/TB27aj7XXXXXXXHXVXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img01.taobaocdn.com/imgextra/i1/134264536/TB2PxAlaFXXXXbaXpXXXXXXXXXX-134264536.jpg","ximgurl":"http://img02.taobaocdn.com/imgextra/i2/134264536/TB2pOCacXXXXXb_XXXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"},{"imgurl":"http://img02.taobaocdn.com/imgextra/i2/134264536/TB2YJt9cXXXXXbmXpXXXXXXXXXX-134264536.jpg","ximgurl":"http://img04.taobaocdn.com/imgextra/i4/134264536/TB2qIR.cXXXXXXVXpXXXXXXXXXX-134264536.jpg","link":"http://www.tiancaiui.com"}]}';case"comment":return'{"id": '+b+',"zindex": '+b+',"name": "评论层'+(b+1)+'","type": "comment","position": {"left": 100,"top":100},"size": {"width":750,"height":150},"activityUrl":"http://www.taobao.com","activityTitle":"活动标题","pagesize":"3"}';case"userdefine":return'{"id": '+b+',"zindex": '+b+',"name": "自定内容'+(b+1)+'","type": "userdefine","size":{"width":680,"height":300},"position": {"left": 100,"top":100},"code":"您的自定义内容(支持html)"}';case"import":return'{"id": '+b+',"zindex": '+b+',"name": "导入层'+(b+1)+'","type": "import","position": {"left": 100,"top":100},"code":""}'}}}).service("ajax",["$rootScope","$http",function(a,b){var c;this.generateCode=function(c,d){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/make",data:{type:c,jsondata:d}}).success(function(b){a.$broadcast("codeGenerateSuccess",b)}).error(function(a,b){console.log(a+b)})},this.getCode=function(){return c},this.saveData=function(c,d){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/curd/save",data:{jsondata:c,username:d}}).success(function(b){a.$broadcast("savestatus",b)})},this.updateData=function(c,d){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/curd/update",data:{jsondata:c,jid:d}}).success(function(b){a.$broadcast("updatestatus",b)})},this.getJsonList=function(c,d,e,f,g){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/curd/"+c,data:{username:d,page:e,jid:f,status:g}}).success(function(b){a.$broadcast("getlist",b)})},this.open=function(c){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/curd/open",data:{jid:c}}).success(function(b){a.$broadcast("open",b)})},this.getDate=function(c,d,e,f){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/curd/"+c,data:{username:d,beforepass:e,pass:f}}).success(function(b){a.$broadcast("userDataReady",b)})},this.preViewt=function(c,d,e){b({method:"POST",url:"http://www.tiancaiui.com/tool/ajax/index.php/make/preview",data:{data:c,name:d,type:e}}).success(function(b){a.$broadcast("viewSuccess",b)})}}]).factory("md5",function(){var a={createHash:function(a){var b,c,d,e,f,g,h,i,j,k,l=function(a,b){return a<<b|a>>>32-b},m=function(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f},n=function(a,b,c){return a&b|~a&c},o=function(a,b,c){return a&c|b&~c},p=function(a,b,c){return a^b^c},q=function(a,b,c){return b^(a|~c)},r=function(a,b,c,d,e,f,g){return a=m(a,m(m(n(b,c,d),e),g)),m(l(a,f),b)},s=function(a,b,c,d,e,f,g){return a=m(a,m(m(o(b,c,d),e),g)),m(l(a,f),b)},t=function(a,b,c,d,e,f,g){return a=m(a,m(m(p(b,c,d),e),g)),m(l(a,f),b)},u=function(a,b,c,d,e,f,g){return a=m(a,m(m(q(b,c,d),e),g)),m(l(a,f),b)},v=function(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=new Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i+=1;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g},w=function(a){var b,c,d="",e="";for(c=0;3>=c;c+=1)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d},x=[],y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;
for(x=v(a),h=1732584193,i=4023233417,j=2562383102,k=271733878,b=x.length,c=0;b>c;c+=16)d=h,e=i,f=j,g=k,h=r(h,i,j,k,x[c+0],y,3614090360),k=r(k,h,i,j,x[c+1],z,3905402710),j=r(j,k,h,i,x[c+2],A,606105819),i=r(i,j,k,h,x[c+3],B,3250441966),h=r(h,i,j,k,x[c+4],y,4118548399),k=r(k,h,i,j,x[c+5],z,1200080426),j=r(j,k,h,i,x[c+6],A,2821735955),i=r(i,j,k,h,x[c+7],B,4249261313),h=r(h,i,j,k,x[c+8],y,1770035416),k=r(k,h,i,j,x[c+9],z,2336552879),j=r(j,k,h,i,x[c+10],A,4294925233),i=r(i,j,k,h,x[c+11],B,2304563134),h=r(h,i,j,k,x[c+12],y,1804603682),k=r(k,h,i,j,x[c+13],z,4254626195),j=r(j,k,h,i,x[c+14],A,2792965006),i=r(i,j,k,h,x[c+15],B,1236535329),h=s(h,i,j,k,x[c+1],C,4129170786),k=s(k,h,i,j,x[c+6],D,3225465664),j=s(j,k,h,i,x[c+11],E,643717713),i=s(i,j,k,h,x[c+0],F,3921069994),h=s(h,i,j,k,x[c+5],C,3593408605),k=s(k,h,i,j,x[c+10],D,38016083),j=s(j,k,h,i,x[c+15],E,3634488961),i=s(i,j,k,h,x[c+4],F,3889429448),h=s(h,i,j,k,x[c+9],C,568446438),k=s(k,h,i,j,x[c+14],D,3275163606),j=s(j,k,h,i,x[c+3],E,4107603335),i=s(i,j,k,h,x[c+8],F,1163531501),h=s(h,i,j,k,x[c+13],C,2850285829),k=s(k,h,i,j,x[c+2],D,4243563512),j=s(j,k,h,i,x[c+7],E,1735328473),i=s(i,j,k,h,x[c+12],F,2368359562),h=t(h,i,j,k,x[c+5],G,4294588738),k=t(k,h,i,j,x[c+8],H,2272392833),j=t(j,k,h,i,x[c+11],I,1839030562),i=t(i,j,k,h,x[c+14],J,4259657740),h=t(h,i,j,k,x[c+1],G,2763975236),k=t(k,h,i,j,x[c+4],H,1272893353),j=t(j,k,h,i,x[c+7],I,4139469664),i=t(i,j,k,h,x[c+10],J,3200236656),h=t(h,i,j,k,x[c+13],G,681279174),k=t(k,h,i,j,x[c+0],H,3936430074),j=t(j,k,h,i,x[c+3],I,3572445317),i=t(i,j,k,h,x[c+6],J,76029189),h=t(h,i,j,k,x[c+9],G,3654602809),k=t(k,h,i,j,x[c+12],H,3873151461),j=t(j,k,h,i,x[c+15],I,530742520),i=t(i,j,k,h,x[c+2],J,3299628645),h=u(h,i,j,k,x[c+0],K,4096336452),k=u(k,h,i,j,x[c+7],L,1126891415),j=u(j,k,h,i,x[c+14],M,2878612391),i=u(i,j,k,h,x[c+5],N,4237533241),h=u(h,i,j,k,x[c+12],K,1700485571),k=u(k,h,i,j,x[c+3],L,2399980690),j=u(j,k,h,i,x[c+10],M,4293915773),i=u(i,j,k,h,x[c+1],N,2240044497),h=u(h,i,j,k,x[c+8],K,1873313359),k=u(k,h,i,j,x[c+15],L,4264355552),j=u(j,k,h,i,x[c+6],M,2734768916),i=u(i,j,k,h,x[c+13],N,1309151649),h=u(h,i,j,k,x[c+4],K,4149444226),k=u(k,h,i,j,x[c+11],L,3174756917),j=u(j,k,h,i,x[c+2],M,718787259),i=u(i,j,k,h,x[c+9],N,3951481745),h=m(h,d),i=m(i,e),j=m(j,f),k=m(k,g);var O=w(h)+w(i)+w(j)+w(k);return O.toLowerCase()}};return a});var app=angular.module("toolApp");app.filter("unsafe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),angular.module("colorpicker.module",[]).factory("Helper",function(){return{closestSlider:function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;return b.bind(a)("I")?a.parentNode:a},getOffset:function(a,b){for(var c=0,d=0,e=0,f=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft,d+=a.offsetTop,b||"BODY"!==a.tagName?(e+=a.scrollLeft,f+=a.scrollTop):(e+=document.documentElement.scrollLeft||a.scrollLeft,f+=document.documentElement.scrollTop||a.scrollTop),a=a.offsetParent;return{top:d,left:c,scrollX:e,scrollY:f}},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}]}}).factory("Color",["Helper",function(a){return{value:{h:1,s:1,b:1,a:1},rgb:function(){var a=this.toRGB();return"rgb("+a.r+","+a.g+","+a.b+")"},rgba:function(){var a=this.toRGB();return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},hex:function(){return this.toHex()},RGBtoHSB:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g,h;return g=Math.max(a,b,c),h=g-Math.min(a,b,c),e=0===h?null:g===a?(b-c)/h:g===b?(c-a)/h+2:(a-b)/h+4,e=(e+360)%6*60/360,f=0===h?0:h/g,{h:e||1,s:f,b:g,a:d||1}},setColor:function(b){angular.isDefined(b)&&(b=b.toLowerCase());for(var c in a.stringParsers)if(a.stringParsers.hasOwnProperty(c)){var d=a.stringParsers[c],e=d.re.exec(b),f=e&&d.parse(e);if(f)return this.value=this.RGBtoHSB.apply(null,f),!1}},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setLightness:function(a){this.value.b=1-a},setAlpha:function(a){this.value.a=parseInt(100*(1-a),10)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Math.abs(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g),a:d||this.value.a}},toHex:function(a,b,c,d){var e=this.toRGB(a,b,c,d);return"#"+(1<<24|parseInt(e.r,10)<<16|parseInt(e.g,10)<<8|parseInt(e.b,10)).toString(16).substr(1)}}}]).factory("Slider",["Helper",function(a){var b={maxLeft:0,maxTop:0,callLeft:null,callTop:null,knob:{top:0,left:0}},c={};return{getSlider:function(){return b},getLeftPosition:function(a){return Math.max(0,Math.min(b.maxLeft,b.left+((a.pageX||c.left)-c.left)))},getTopPosition:function(a){return Math.max(0,Math.min(b.maxTop,b.top+((a.pageY||c.top)-c.top)))},setSlider:function(d,e){var f=a.closestSlider(d.target),g=a.getOffset(f,e);b.knob=f.children[0].style,b.left=d.pageX-g.left-window.pageXOffset+g.scrollX,b.top=d.pageY-g.top-window.pageYOffset+g.scrollY,c={left:d.pageX,top:d.pageY}},setSaturation:function(a,c){b={maxLeft:150,maxTop:150,callLeft:"setSaturation",callTop:"setLightness"},this.setSlider(a,c)},setHue:function(a,c){b={maxLeft:0,maxTop:150,callLeft:!1,callTop:"setHue"},this.setSlider(a,c)},setAlpha:function(a,c){b={maxLeft:0,maxTop:150,callLeft:!1,callTop:"setAlpha"},this.setSlider(a,c)},setKnob:function(a,c){b.knob.top=a+"px",b.knob.left=c+"px"}}}]).directive("colorpicker",["$document","$compile","$parse","Color","Slider","Helper",function(a,b,c,d,e,f){return{require:"?ngModel",restrict:"A",scope:{},link:function(c,g,h,i){var j,k=h.colorpicker?h.colorpicker:"hex",l=angular.isDefined(h.colorpickerPosition)?h.colorpickerPosition:"bottom",m=angular.isDefined(h.colorpickerInline)?h.colorpickerInline:!1,n=angular.isDefined(h.colorpickerFixedPosition)?h.colorpickerFixedPosition:!1,o=angular.isDefined(h.colorpickerParent)?g.parent():angular.element(document.body),p=angular.isDefined(h.colorpickerWithInput)?h.colorpickerWithInput:!1,q=p?'<input type="text" name="colorpicker-input"></div>':"",r=m?"":'<button type="button" class="tiny button">&times;</button>',s='<div class="colorpicker f-dropdown animated n'+l+'"><div class="left" ng-include="\'views/generatedcolor.html\'"></div><div class="right rcolorpicker"><colorpicker-saturation><i></i></colorpicker-saturation><colorpicker-hue><i></i></colorpicker-hue><colorpicker-alpha><i></i></colorpicker-alpha><colorpicker-preview>Preview</colorpicker-preview>'+q+r+"</div>",t=angular.element(s),u=d,v=t.find("colorpicker-hue"),w=t.find("colorpicker-saturation"),x=t.find("colorpicker-preview"),y=t.find("i");if(b(t)(c),p){var z=t.find("input");z.on("mousedown",function(a){a.stopPropagation()}).on("keyup",function(a){var b=this.value;g.val(b),c.objvalue=b,i&&c.$apply(i.$setViewValue(b)),a.stopPropagation(),a.preventDefault()}),g.on("keyup",function(){z.val(g.val())})}var A=function(){a.on("mousemove",C),a.on("mouseup",D)};"rgba"===k&&(t.addClass("alpha"),j=t.find("colorpicker-alpha"),j.on("click",function(a){e.setAlpha(a,n),C(a)}).on("mousedown",function(a){e.setAlpha(a,n),A()})),v.on("click",function(a){e.setHue(a,n),C(a)}).on("mousedown",function(a){e.setHue(a,n),A()}),w.on("click",function(a){e.setSaturation(a,n),C(a)}).on("mousedown",function(a){e.setSaturation(a,n),A()}),n&&t.addClass("colorpicker-fixed-position"),t.addClass("colorpicker-position-"+l),"true"===m&&t.addClass("colorpicker-inline"),o.append(t),i&&(i.$render=function(){g.val(i.$viewValue)},c.$watch(h.ngModel,function(a){E(),p&&(z.val(a),c.objvalue=a)})),g.on("$destroy",function(){t.remove()});var B=function(){try{"transparent"==i.$viewValue?x.css("backgroundColor",u[k]()):x.css("backgroundColor",i.$viewValue)}catch(a){x.css("backgroundColor",u.toHex())}w.css("backgroundColor",u.toHex(u.value.h,1,1,1)),"rgba"===k&&(j.css.backgroundColor=u.toHex())},C=function(a){var b=e.getLeftPosition(a),d=e.getTopPosition(a),f=e.getSlider();e.setKnob(d,b),f.callLeft&&u[f.callLeft].call(u,b/150),f.callTop&&u[f.callTop].call(u,d/150),B();var h=u[k]();return g.val(h),c.objvalue=h,i&&c.$apply(i.$setViewValue(h)),p&&z.val(h),!1},D=function(){a.off("mousemove",C),a.off("mouseup",D)},E=function(){u.setColor(g.val()),y.eq(0).css({left:150*u.value.s+"px",top:150-150*u.value.b+"px"}),y.eq(1).css("top",150*(1-u.value.h)+"px"),y.eq(2).css("top",150*(1-u.value.a)+"px"),B()},F=function(){var a,b=f.getOffset(g[0]);return angular.isDefined(h.colorpickerParent)&&(b.left=0,b.top=0),"top"===l?a={top:b.top-240,left:b.left-400}:"right"===l?a={top:b.top,left:b.left+126}:"bottom"===l?a={top:b.top+g[0].offsetHeight+2,left:b.left}:"left"===l&&(a={top:b.top+30,left:b.left}),{top:a.top+"px",left:a.left+"px"}},G=function(){K()},H=h.inmethod,I=h.outmethod;m===!1?g.on("click",function(){E(),t.removeClass(I).addClass("colorpicker-visible").addClass(H).css(F()),a.on("mousedown",G)}):(E(),t.removeClass(I).addClass("colorpicker-visible").addClass(H).css(F())),t.on("mousedown",function(a){a.stopPropagation(),a.preventDefault()});var J=function(a){i&&c.$emit(a,{name:h.ngModel,value:i.$modelValue})},K=function(){t.hasClass("colorpicker-visible")&&(t.removeClass(H).addClass(I),J("colorpicker-closed"),a.off("mousedown",G))};c.changeColor=function(a){i.$setViewValue(a),c.objvalue=a},t.find("button").on("click",function(){K()})}}}]);